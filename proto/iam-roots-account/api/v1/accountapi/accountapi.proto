syntax = "proto3";

package garajonai.platform.iamrootsaccount.api.bff.v1;

option go_package = "github.com/garajonai/client-go/iam-roots-account/api/bff/v1;accountapi";

import "google/api/annotations.proto";
import "garajonai/platform/proto/iam-roots-account/api/v1/webauthn.proto";

service IAMRootsAccountApi {
    rpc StartWebauthnRegistration(StartWebauthnRegistrationRequest) returns (StartWebauthnRegistrationResponse) {
        option (google.api.http) = {
            post: "/registration/webauthn/start"
            body: "*"
        };
    }
    rpc FinishWebauthnRegistration(FinishWebauthnRegistrationRequest) returns (FinishWebauthnRegistrationResponse) {
        option (google.api.http) = {
            post: "/registration/webauthn/finish"
            body: "*"
        };
    }
}


message StartWebauthnRegistrationRequest {
    string email = 1;
}

message StartWebauthnRegistrationResponse {
    garajonai.platform.iamrootsaccount.api.v1.PublicKey public_key = 1;
}

message FinishWebauthnRegistrationRequest {
    string email = 1;
    string id = 2;
    bytes raw_id = 3;
    string type = 4;
    repeated string transports = 5;
    garajonai.platform.iamrootsaccount.api.v1.AttestationResponse response = 6;
}

message FinishWebauthnRegistrationResponse {
    string status = 1;
}
